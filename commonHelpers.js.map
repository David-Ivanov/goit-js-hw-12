{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict'\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\n\nimport axios from \"axios\";\n\nconst form = document.querySelector(\"form\");\nconst imagesContainer = document.querySelector(\".images\");\nconst loader = document.querySelector(\".loader\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\n\n// create axios instance\nconst instance = axios.create({\n    method: 'get',\n    baseURL: 'https://pixabay.com/api/',\n    params: {\n        key: '41610080-031e2cebad3f84a1c0bee486b',\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: 40,\n    }\n});\n\n// pages\nlet page = 1;\nconst pageOfQuery = () => {\n    page++;\n\n}\n\n// make gallery for SimpleLightbox\nlet gallery = new SimpleLightbox(\".images a\", {\n    captionsData: 'alt',\n    captionDelay: 250\n});\n\n// create value for search\nlet value;\n\nform.addEventListener('submit', async event => {\n    event.preventDefault();\n\n    // reset pages\n    page = 1;\n\n    // reset imagesContainer\n    imagesContainer.innerHTML = '';\n\n    // show loader\n    loader.style.display = 'block';\n\n    // set query parametrs\n    value = event.target.elements.search.value;\n\n    // render images or show error\n    try {\n        const images = await instance({\n            params: {\n                q: value,\n                page,\n            }\n        });\n        console.log(images.data.total);\n        innerImages(images.data);\n    } catch (error) {\n        showUnfindError();\n    }\n\n    // reset form and loader\n    loader.style.display = 'none';\n    form.reset();\n});\n\n\n\nloadMoreBtn.addEventListener('click', async () => {\n    // next page\n    pageOfQuery();\n\n    // inner more images\n    try {\n        const images = await instance({\n            params: {\n                q: value,\n                page,\n            }\n        });\n\n        addImages(images.data);\n\n        // scroll page \n        scrollPage();\n    } catch (error) {\n        showEmptyError();\n\n        // scroll page \n        scrollPage();\n    }\n\n\n});\n\nconst makeHTMLToInner = images => {\n    return images.hits.map(({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => `\n    <li class=\"img\">\n       <a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\"></a>\n      <ul class=\"img-info\">\n        <li class=\"img-info-item\"><span>Likes</span> ${likes}</li>\n        <li class=\"img-info-item\"><span>Views</span> ${views}</li>\n        <li class=\"img-info-item\"><span>Comments</span> ${comments}</li>\n        <li class=\"img-info-item\"><span>Downloads</span> ${downloads}</li>\n      </ul>\n    </li>`).join('');\n}\n\n// inner HTML\n\nconst innerImages = images => {\n    if (images.hits.length === 0) throw new Error(images.status);\n\n    imagesContainer.innerHTML = makeHTMLToInner(images);\n\n    // show btn Load more\n    loadMoreBtn.style.display = \"block\";\n\n    // check if the server isn't empty\n    if (Math.ceil(images.total / 40) <= page) {\n        showEmptyError();\n    }\n\n    // refresh gallery for simpleLightBox\n    gallery.refresh();\n}\n\nconst addImages = images => {\n    if (Math.ceil(images.total / 40) <= page) {\n        // check if the server isn't empty\n        imagesContainer.insertAdjacentHTML('beforeend', makeHTMLToInner(images));\n        // refresh gallery for simpleLightBox\n        gallery.refresh();\n\n        throw new Error(images.status);\n    }\n\n    imagesContainer.insertAdjacentHTML('beforeend', makeHTMLToInner(images));\n\n    // refresh gallery for simpleLightBox\n    gallery.refresh();\n}\n\n// errors\n\nconst showUnfindError = () => {\n    iziToast.show({\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        maxWidth: 432,\n        iconUrl: './images/error-icon.svg',\n        iconColor: '#FFFFFF',\n        backgroundColor: '#EF4040',\n        messageColor: '#FFFFFF',\n        position: 'topRight'\n    });\n\n    // hide btn Load more\n    loadMoreBtn.style.display = \"none\";\n\n    // reset container\n    imagesContainer.innerHTML = '';\n}\n\nconst showEmptyError = () => {\n    iziToast.show({\n        message: `We're sorry, but you've reached the end of search results.`,\n        maxWidth: 432,\n        iconUrl: './images/error-icon.svg',\n        iconColor: '#FFFFFF',\n        backgroundColor: '#87CEEB',\n        messageColor: '#FFFFFF',\n        position: 'topRight'\n    });\n    // hide btn Load more\n    loadMoreBtn.style.display = \"none\";\n}\n\n// scroll\n\nconst scrollPage = () => {\n    const height = document.querySelector(\".img\").getBoundingClientRect().height * 2\n    window.scrollBy({\n        top: height,\n        behavior: \"smooth\",\n    });\n}\n\n"],"names":["form","imagesContainer","loader","loadMoreBtn","instance","axios","page","pageOfQuery","gallery","SimpleLightbox","value","event","images","innerImages","showUnfindError","addImages","scrollPage","showEmptyError","makeHTMLToInner","largeImageURL","webformatURL","tags","likes","views","comments","downloads","iziToast","height"],"mappings":"owBASA,MAAMA,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAkB,SAAS,cAAc,SAAS,EAClDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,YAAY,EAGjDC,EAAWC,EAAM,OAAO,CAC1B,OAAQ,MACR,QAAS,2BACT,OAAQ,CACJ,IAAK,qCACL,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,EACb,CACL,CAAC,EAGD,IAAIC,EAAO,EACX,MAAMC,EAAc,IAAM,CACtBD,GAEJ,EAGA,IAAIE,EAAU,IAAIC,EAAe,YAAa,CAC1C,aAAc,MACd,aAAc,GAClB,CAAC,EAGGC,EAEJV,EAAK,iBAAiB,SAAU,MAAMW,GAAS,CAC3CA,EAAM,eAAc,EAGpBL,EAAO,EAGPL,EAAgB,UAAY,GAG5BC,EAAO,MAAM,QAAU,QAGvBQ,EAAQC,EAAM,OAAO,SAAS,OAAO,MAGrC,GAAI,CACA,MAAMC,EAAS,MAAMR,EAAS,CAC1B,OAAQ,CACJ,EAAGM,EACH,KAAAJ,CACH,CACb,CAAS,EACD,QAAQ,IAAIM,EAAO,KAAK,KAAK,EAC7BC,EAAYD,EAAO,IAAI,CAC1B,MAAC,CACEE,GACH,CAGDZ,EAAO,MAAM,QAAU,OACvBF,EAAK,MAAK,CACd,CAAC,EAIDG,EAAY,iBAAiB,QAAS,SAAY,CAE9CI,IAGA,GAAI,CACA,MAAMK,EAAS,MAAMR,EAAS,CAC1B,OAAQ,CACJ,EAAGM,EACH,KAAAJ,CACH,CACb,CAAS,EAEDS,EAAUH,EAAO,IAAI,EAGrBI,GACH,MAAC,CACEC,IAGAD,GACH,CAGL,CAAC,EAED,MAAME,EAAkBN,GACbA,EAAO,KAAK,IAAI,CAAC,CAAE,cAAAO,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAAK;AAAA;AAAA,kBAEvFN,gBAA4BC,WAAsBC;AAAA;AAAA,uDAEbC;AAAA,uDACAC;AAAA,0DACGC;AAAA,2DACCC;AAAA;AAAA,UAEjD,EAAE,KAAK,EAAE,EAKbZ,EAAcD,GAAU,CAC1B,GAAIA,EAAO,KAAK,SAAW,EAAG,MAAM,IAAI,MAAMA,EAAO,MAAM,EAE3DX,EAAgB,UAAYiB,EAAgBN,CAAM,EAGlDT,EAAY,MAAM,QAAU,QAGxB,KAAK,KAAKS,EAAO,MAAQ,EAAE,GAAKN,GAChCW,IAIJT,EAAQ,QAAO,CACnB,EAEMO,EAAYH,GAAU,CACxB,GAAI,KAAK,KAAKA,EAAO,MAAQ,EAAE,GAAKN,EAEhC,MAAAL,EAAgB,mBAAmB,YAAaiB,EAAgBN,CAAM,CAAC,EAEvEJ,EAAQ,QAAO,EAET,IAAI,MAAMI,EAAO,MAAM,EAGjCX,EAAgB,mBAAmB,YAAaiB,EAAgBN,CAAM,CAAC,EAGvEJ,EAAQ,QAAO,CACnB,EAIMM,EAAkB,IAAM,CAC1BY,EAAS,KAAK,CACV,QAAS,2EACT,SAAU,IACV,QAAS,0BACT,UAAW,UACX,gBAAiB,UACjB,aAAc,UACd,SAAU,UAClB,CAAK,EAGDvB,EAAY,MAAM,QAAU,OAG5BF,EAAgB,UAAY,EAChC,EAEMgB,EAAiB,IAAM,CACzBS,EAAS,KAAK,CACV,QAAS,6DACT,SAAU,IACV,QAAS,0BACT,UAAW,UACX,gBAAiB,UACjB,aAAc,UACd,SAAU,UAClB,CAAK,EAEDvB,EAAY,MAAM,QAAU,MAChC,EAIMa,EAAa,IAAM,CACrB,MAAMW,EAAS,SAAS,cAAc,MAAM,EAAE,sBAAqB,EAAG,OAAS,EAC/E,OAAO,SAAS,CACZ,IAAKA,EACL,SAAU,QAClB,CAAK,CACL"}